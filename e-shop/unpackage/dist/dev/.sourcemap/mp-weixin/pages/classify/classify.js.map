{"version":3,"file":"classify.js","sources":["pages/classify/classify.uvue","../../../Downloads/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3NpZnkvY2xhc3NpZnkudXZ1ZQ"],"sourcesContent":["<template>\n  <page>\n    <view class=\"classify-main\">\n\n      <!-- 左侧分类 -->\n      <scroll-view scroll-y class=\"classify-left\" scroll-with-animation=\"true\">\n        <view\n          class=\"item\"\n          v-for=\"item in oneClassifyList\"\n          :key=\"item.id\"\n          :class=\"{ active: oneClassifyId === item.id }\"\n          @click=\"onOneClassify(item.id)\"\n        >\n          <text class=\"line\" :class=\"{ 'line-active': oneClassifyId === item.id }\"></text>\n          <text class=\"text\" :class=\"{ 'text-active': oneClassifyId === item.id }\">\n            {{ item.name }}\n          </text>\n        </view>\n      </scroll-view>\n\n      <!-- 右侧商品列表：当前分类下的所有商品，一条一条显示 -->\n      <scroll-view scroll-y class=\"classify-right\" scroll-with-animation=\"true\">\n        <view\n          class=\"goods-item\"\n          v-for=\"goods in productList\"\n          :key=\"goods.id\"\n          @click=\"onGoodsClick(goods)\"\n        >\n          <image :src=\"goods.pic\" class=\"goods-img\" />\n          <view class=\"goods-info\">\n            <text class=\"goods-name\">{{ goods.name }}</text>\n            <text class=\"goods-price\">￥{{ goods.price }}</text>\n          </view>\n        </view>\n\n        <!-- 没有商品时的提示 -->\n        <view v-if=\"!productList.length\" class=\"empty\">\n          暂无该分类下的课程\n        </view>\n      </scroll-view>\n\n    </view>\n  </page>\n</template>\n\n<script lang=\"uts\">\nexport default {\n  data() {\n    return {\n      oneClassifyList: [], // 左侧分类（parent_id = 0）\n      allProducts: [],     // 所有商品\n      productList: [],     // 当前分类下的商品\n      oneClassifyId: 0     // 当前选中的分类 id\n    }\n  },\n\n  async onLoad() {\n    await this.loadCategories()\n    await this.loadProducts()\n    this.refreshProducts()\n  },\n\n  methods: {\n    // 加载分类列表\nasync loadCategories() {\n  const res = await uni.request({\n    url: 'https://wdxwhdglzx.jzzw-tech.cn/api/categories/list'\n  })\n\n  const list = res.data.data || []\n\n  // ✨ 直接全部展示，不分级、不过滤\n  this.oneClassifyList = list.sort((a, b) => a.sort_order - b.sort_order)\n\n  // 默认选中第一项\n  if (this.oneClassifyList.length) {\n    this.oneClassifyId = this.oneClassifyList[0].id\n  }\n}\n,\n\n    // 加载商品列表\n    async loadProducts() {\n      const res = await uni.request({\n        url: 'https://wdxwhdglzx.jzzw-tech.cn/api/products/list'\n      })\n      const list = res.data.data || []\n\n      // 把后端数据整理一下，方便前端使用\n      this.allProducts = list.map(p => {\n        // 取 sku 里最便宜的价格\n        let price = '0.00'\n        if (p.skus && p.skus.length) {\n          const min = p.skus.reduce((pre, cur) => {\n            const prePrice = parseFloat(pre.price || pre)\n            const curPrice = parseFloat(cur.price)\n            return prePrice < curPrice ? prePrice : curPrice\n          }, p.skus[0].price)\n          price = Number(min).toFixed(2)\n        }\n\n        return {\n          id: p.id,\n          name: p.name,\n          pic: (p.images && p.images[0]) || '',\n          price,\n          category_id: p.category_id\n        }\n      })\n    },\n\n    // 根据当前选中分类，刷新右侧商品列表\n    refreshProducts() {\n      this.productList = this.allProducts.filter(\n        p => p.category_id === this.oneClassifyId\n      )\n    },\n\n    // 点击左侧分类\n    onOneClassify(id) {\n      this.oneClassifyId = id\n      this.refreshProducts()\n    },\n\nonGoodsClick(goods) {\n  uni.navigateTo({\n    url: `/pages/GoodsDetail/GoodsDetail?goodsId=${goods.id}`\n  })\n}\n\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import \"classify.scss\";\n</style>\n","import MiniProgramPage from 'C:/Users/若涵/Desktop/接单/e-shop/pages/classify/classify.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":";;AA8CA,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,iBAAiB,CAAE;AAAA,MACnB,aAAa,CAAE;AAAA,MACf,aAAa,CAAE;AAAA,MACf,eAAe;AAAA;AAAA;EAElB;AAAA,EAEK,SAAM;;AACV,YAAM,KAAK;AACX,YAAM,KAAK;AACX,WAAK,gBAAe;AAAA,KACrB;AAAA,EAAA;AAAA,EAED,SAAS;AAAA;AAAA,IAEL,iBAAc;;AAClB,cAAM,MAAM,MAAMC,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK;AAAA,QACN,CAAA;AAED,cAAM,OAAO,IAAI,KAAK,QAAQ,CAAA;AAG9B,aAAK,kBAAkB,KAAK,KAAK,CAAC,IAAC,MAAE,aAAM;AAAA,iBAAA,EAAE,aAAa,EAAE;AAAA,QAAU,CAAA;AAGtE,YAAI,KAAK,gBAAgB,QAAQ;AAC/B,eAAK,gBAAgB,KAAK,gBAAgB,CAAC,EAAE;AAAA,QAC/C;AAAA,OACF;AAAA,IAAA;AAAA;AAAA,IAIU,eAAY;;AAChB,cAAM,MAAM,MAAMA,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK;AAAA,QACN,CAAA;AACD,cAAM,OAAO,IAAI,KAAK,QAAQ,CAAA;AAG9B,aAAK,cAAc,KAAK,IAAI,CAAA,IAAE,SAAA;AAE5B,cAAI,QAAQ;AACZ,cAAI,EAAE,QAAQ,EAAE,KAAK,QAAQ;AAC3B,kBAAM,MAAM,EAAE,KAAK,OAAO,CAAC,MAAG,MAAE,MAAG,SAAA;AACjC,oBAAM,WAAW,WAAW,IAAI,SAAS,GAAG;AAC5C,oBAAM,WAAW,WAAW,IAAI,KAAK;AACrC,qBAAO,WAAW,WAAW,WAAW;AAAA,YACzC,GAAE,EAAE,KAAK,CAAC,EAAE,KAAK;AAClB,oBAAQ,OAAO,GAAG,EAAE,QAAQ,CAAC;AAAA,UAC/B;AAEA,iBAAO,IAAA,cAAA;AAAA,YACL,IAAI,EAAE;AAAA,YACN,MAAM,EAAE;AAAA,YACR,KAAM,EAAE,UAAU,EAAE,OAAO,CAAC,KAAM;AAAA,YAClC;AAAA,YACA,aAAa,EAAE;AAAA,WACjB;AAAA,QACF,CAAC;AAAA,OACF;AAAA,IAAA;AAAA;AAAA,IAGD,kBAAe;AACb,WAAK,cAAc,KAAK,YAAY,OAClC,OAAA;AAAK,eAAA,EAAE,gBAAgB,KAAK;AAAA,MAAY,CAAA;AAAA,IAE3C;AAAA;AAAA,IAGD,cAAc,KAAE,MAAA;AACd,WAAK,gBAAgB;AACrB,WAAK,gBAAe;AAAA,IACrB;AAAA,IAEL,aAAa,QAAK,MAAA;AAChBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,0CAA0C,MAAM,EAAE;AAAA,MACxD,CAAA;AAAA,IACH;AAAA,EAEE;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}