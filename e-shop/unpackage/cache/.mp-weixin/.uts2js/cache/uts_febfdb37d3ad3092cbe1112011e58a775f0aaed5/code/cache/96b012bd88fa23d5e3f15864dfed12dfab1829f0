{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n    data() {\n        return {\n            oneClassifyList: [],\n            allProducts: [],\n            productList: [],\n            oneClassifyId: 0 // 当前选中的分类 id\n        };\n    },\n    onLoad() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.loadCategories();\n            yield this.loadProducts();\n            this.refreshProducts();\n        });\n    },\n    methods: {\n        // 加载分类列表\n        loadCategories() {\n            return __awaiter(this, void 0, void 0, function* () {\n                const res = yield uni.request({\n                    url: 'https://wdxwhdglzx.jzzw-tech.cn/api/categories/list'\n                });\n                const list = res.data.data || [];\n                // ✨ 直接全部展示，不分级、不过滤\n                this.oneClassifyList = list.sort((a = null, b = null) => { return a.sort_order - b.sort_order; });\n                // 默认选中第一项\n                if (this.oneClassifyList.length) {\n                    this.oneClassifyId = this.oneClassifyList[0].id;\n                }\n            });\n        },\n        // 加载商品列表\n        loadProducts() {\n            return __awaiter(this, void 0, void 0, function* () {\n                const res = yield uni.request({\n                    url: 'https://wdxwhdglzx.jzzw-tech.cn/api/products/list'\n                });\n                const list = res.data.data || [];\n                // 把后端数据整理一下，方便前端使用\n                this.allProducts = list.map((p = null) => {\n                    // 取 sku 里最便宜的价格\n                    let price = '0.00';\n                    if (p.skus && p.skus.length) {\n                        const min = p.skus.reduce((pre = null, cur = null) => {\n                            const prePrice = parseFloat(pre.price || pre);\n                            const curPrice = parseFloat(cur.price);\n                            return prePrice < curPrice ? prePrice : curPrice;\n                        }, p.skus[0].price);\n                        price = Number(min).toFixed(2);\n                    }\n                    return new UTSJSONObject({\n                        id: p.id,\n                        name: p.name,\n                        pic: (p.images && p.images[0]) || '',\n                        price,\n                        category_id: p.category_id\n                    });\n                });\n            });\n        },\n        // 根据当前选中分类，刷新右侧商品列表\n        refreshProducts() {\n            this.productList = this.allProducts.filter(p => { return p.category_id === this.oneClassifyId; });\n        },\n        // 点击左侧分类\n        onOneClassify(id = null) {\n            this.oneClassifyId = id;\n            this.refreshProducts();\n        },\n        onGoodsClick(goods = null) {\n            uni.navigateTo({\n                url: `/pages/GoodsDetail/GoodsDetail?goodsId=${goods.id}`\n            });\n        }\n    }\n});\n//# sourceMappingURL=C:/Users/%E8%8B%A5%E6%B6%B5/Desktop/%E6%8E%A5%E5%8D%95/e-shop/pages/classify/classify.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.request","uni.navigateTo"],"map":"{\"version\":3,\"file\":\"classify.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"classify.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
